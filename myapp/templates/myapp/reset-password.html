{% extends 'myapp/base1.html' %}
{% load static %}

{% block content %}
<section class="section-hero overlay inner-page bg-image" style="background-image: url('{% static 'images/hero_1.jpg' %}');">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1 class="text-white font-weight-bold">Reset Password</h1>
        <div class="custom-breadcrumbs">
          <a href="{% url 'home' %}">Home</a> <span class="mx-2 slash">/</span>
          <span class="text-white"><strong>Reset Password</strong></span>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="site-section" style="padding: 4rem 0;">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-5">
        <div class="card shadow-lg border-0" style="border-radius: 15px;">
          <div class="card-body p-5">
            <div class="text-center mb-4">
              <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                <span style="font-size: 2rem;">üîê</span>
              </div>
              <h3 style="color: #2c3e50; font-weight: 700;">Reset Your Password</h3>
              <p class="text-muted">Enter the OTP sent to <strong>{{ email }}</strong></p>
            </div>

            {% if msg %}
            <div class="alert {% if '‚ùå' in msg %}alert-danger{% elif '‚úÖ' in msg %}alert-success{% else %}alert-warning{% endif %} alert-dismissible fade show" role="alert">
              {{ msg }}
              <button type="button" class="close" data-dismiss="alert">&times;</button>
            </div>
            {% endif %}

            {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
              {{ message }}
              <button type="button" class="close" data-dismiss="alert">&times;</button>
            </div>
            {% endfor %}
            {% endif %}

            <form method="POST" action="{% url 'reset_password' %}">
              {% csrf_token %}
              <input type="hidden" name="email" value="{{ email }}">
              
              <div class="form-group mb-3">
                <label for="otp" style="font-weight: 600; color: #2c3e50;">Enter OTP</label>
                <input type="text" name="otp" id="otp" class="form-control text-center" 
                       placeholder="Enter 5-digit OTP" required maxlength="5"
                       style="font-size: 1.5rem; letter-spacing: 10px; padding: 0.75rem; font-weight: bold;">
              </div>

              <div class="form-group mb-3">
                <label for="new_password" style="font-weight: 600; color: #2c3e50;">New Password</label>
                <div class="input-group">
                  <div class="input-group-prepend">
                    <span class="input-group-text" style="background: #f8f9fa; border-right: none;">
                      <span class="icon-lock" style="color: #667eea;"></span>
                    </span>
                  </div>
                  <input type="password" name="new_password" id="new_password" class="form-control" 
                         placeholder="Enter new password" required minlength="6"
                         style="border-left: none; padding: 0.75rem;">
                </div>
              </div>

              <div class="form-group mb-4">
                <label for="confirm_password" style="font-weight: 600; color: #2c3e50;">Confirm Password</label>
                <div class="input-group">
                  <div class="input-group-prepend">
                    <span class="input-group-text" style="background: #f8f9fa; border-right: none;">
                      <span class="icon-lock" style="color: #667eea;"></span>
                    </span>
                  </div>
                  <input type="password" name="confirm_password" id="confirm_password" class="form-control" 
                         placeholder="Confirm new password" required minlength="6"
                         style="border-left: none; padding: 0.75rem;">
                </div>
              </div>

              <button type="submit" class="btn btn-block btn-lg text-white" 
                      style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; border-radius: 25px; padding: 0.85rem; font-weight: 600;">
                <span class="icon-check mr-2"></span>Reset Password
              </button>
            </form>

            <div class="text-center mt-4">
              <p class="text-muted mb-2">Didn't receive the OTP?</p>
              <a href="{% url 'resend_reset_otp' %}?email={{ email }}" style="color: #667eea; font-weight: 600;">
                <span class="icon-refresh mr-1"></span>Resend OTP
              </a>
            </div>

            <div class="text-center mt-3">
              <a href="{% url 'login' %}" class="text-muted">
                <span class="icon-arrow-left mr-1"></span>Back to Login
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

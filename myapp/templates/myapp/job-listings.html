{% extends 'myapp/base1.html' %}
{% load static %}
{% block content %}

<!-- HERO SECTION WITH SEARCH -->
<section class="section-hero home-section overlay inner-page bg-image" style="background-image: url('{% static 'images/hero_1.jpg' %}');" id="home-section">
  <div class="container">
    <div class="row align-items-center justify-content-center">
      <div class="col-md-12">
        <div class="mb-5 text-center">
          <h1 class="text-white font-weight-bold">Find Your Dream Job</h1>
          <p class="text-white-50">Browse {{ total_jobs }} available job{{ total_jobs|pluralize }}</p>
        </div>
        
        <!-- Search Form -->
        <form method="GET" action="{% url 'browse_jobs' %}" class="search-jobs-form">
          <div class="row mb-5">
            <div class="col-12 col-sm-6 col-md-6 col-lg-3 mb-4 mb-lg-0">
              <input type="text" name="search" class="form-control form-control-lg" placeholder="Job title, Company..." value="{{ search_query }}">
            </div>
            <div class="col-12 col-sm-6 col-md-6 col-lg-3 mb-4 mb-lg-0">
              <input type="text" name="location" class="form-control form-control-lg" placeholder="Location..." value="{{ location }}">
            </div>
            <div class="col-12 col-sm-6 col-md-6 col-lg-3 mb-4 mb-lg-0">
              <select name="job_type" class="selectpicker" data-style="btn-white btn-lg" data-width="100%" title="Select Job Type">
                <option value="">All Types</option>
                <option value="full-time" {% if job_type == 'full-time' %}selected{% endif %}>Full Time</option>
                <option value="part-time" {% if job_type == 'part-time' %}selected{% endif %}>Part Time</option>
                <option value="contract" {% if job_type == 'contract' %}selected{% endif %}>Contract</option>
                <option value="internship" {% if job_type == 'internship' %}selected{% endif %}>Internship</option>
                <option value="remote" {% if job_type == 'remote' %}selected{% endif %}>Remote</option>
              </select>
            </div>
            <div class="col-12 col-sm-6 col-md-6 col-lg-3 mb-4 mb-lg-0">
              <button type="submit" class="btn btn-primary btn-lg btn-block text-white btn-search" style="background-color: #6A696B; border-color: #6A696B;">
                <span class="icon-search icon mr-2"></span>Search Job
              </button>
            </div>
          </div>
          
          <!-- Experience Filter -->
          <div class="row">
            <div class="col-md-12 text-center">
              <select name="experience" class="selectpicker" data-style="btn-white" data-width="auto" title="Experience Level">
                <option value="">Any Experience</option>
                <option value="0-1" {% if experience == '0-1' %}selected{% endif %}>0-1 years</option>
                <option value="1-3" {% if experience == '1-3' %}selected{% endif %}>1-3 years</option>
                <option value="3-5" {% if experience == '3-5' %}selected{% endif %}>3-5 years</option>
                <option value="5-10" {% if experience == '5-10' %}selected{% endif %}>5-10 years</option>
                <option value="10+" {% if experience == '10+' %}selected{% endif %}>10+ years</option>
              </select>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <a href="#next" class="scroll-button smoothscroll">
    <span class="icon-keyboard_arrow_down"></span>
  </a>
</section>

<!-- JOB LISTINGS SECTION -->
<section class="site-section" id="next" style="padding: 4rem 0;">
  <div class="container">

    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="close" data-dismiss="alert">&times;</button>
        </div>
      {% endfor %}
    {% endif %}

    <div class="row mb-5 justify-content-center">
      <div class="col-md-7 text-center">
        <h2 class="section-title mb-2" style="color: #2c3e50;">{{ total_jobs }} Job{{ total_jobs|pluralize }} Listed</h2>
        {% if search_query or location or job_type or experience %}
        <p style="color: #6c757d;">
          Filtered by: 
          {% if search_query %}<strong>"{{ search_query }}"</strong>{% endif %}
          {% if location %} in <strong>{{ location }}</strong>{% endif %}
          {% if job_type %} | <strong>{{ job_type|title }}</strong>{% endif %}
          {% if experience %} | <strong>{{ experience }} years exp</strong>{% endif %}
          <a href="{% url 'browse_jobs' %}" class="btn btn-sm btn-outline-secondary ml-2">Clear Filters</a>
        </p>
        {% endif %}
      </div>
    </div>
    
    {% if jobs %}
      <ul class="job-listings mb-5">
        {% for job in jobs %}
        <li class="job-listing" onclick="window.location.href='{% url 'job_detail' job.id %}'">
          
          <div class="job-listing-logo">
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
              {{ job.company_name.0|upper }}
            </div>
          </div>

          <div class="job-listing-about">
            <div class="job-listing-position">
              <h2>
                <a href="{% url 'job_detail' job.id %}">{{ job.title }}</a>
              </h2>
              <strong>{{ job.company_name }}</strong>
              {% if job.salary %}
              <div class="mt-1">
                <span>üí∞ {{ job.salary }}</span>
              </div>
              {% endif %}
            </div>
            
            <div class="job-listing-location">
              <span class="icon-room"></span>
              <span>{{ job.location }}</span>
            </div>
            
            <div class="job-listing-meta">
              <span class="badge" style="background-color: #6A696B; color: white;">
                {{ job.get_job_type_display }}
              </span>
              {% if job.is_featured %}
              <span class="badge" style="background-color: #ffc107; color: #000;">
                ‚≠ê FEATURED
              </span>
              {% endif %}
              <small>üïí {{ job.created_at|timesince }} ago</small>
            </div>
          </div>
        </li>
        {% endfor %}
      </ul>

      <!-- Pagination -->
      <div class="row pagination-wrap">
        <div class="col-md-6 text-center text-md-left mb-4 mb-md-0">
          <span style="color: #6c757d;">Showing {{ jobs|length }} of {{ total_jobs }} Jobs</span>
        </div>
        <div class="col-md-6 text-center text-md-right">
          <!-- Pagination can be added here if needed -->
        </div>
      </div>

    {% else %}
      <div class="text-center py-5">
        <div style="font-size: 4rem; color: #6c757d; margin-bottom: 1rem;">
          <span class="icon-search"></span>
        </div>
        <h3 style="color: #6c757d;">No jobs found</h3>
        <p style="color: #6c757d;">
          {% if search_query or location or job_type or experience %}
            No jobs match your search criteria. Try adjusting your filters.
          {% else %}
            No jobs are currently available. Check back soon!
          {% endif %}
        </p>
        <a href="{% url 'browse_jobs' %}" class="btn btn-primary mt-3" style="background-color: #6A696B; border-color: #6A696B;">View All Jobs</a>
      </div>
    {% endif %}

  </div>
</section>

<!-- CALL TO ACTION -->
<section class="py-5 bg-image overlay-primary fixed overlay" style="background-image: url('{% static 'images/hero_1.jpg' %}');">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-8">
        <h2 class="text-white">Looking For A Job?</h2>
        <p class="mb-0 text-white lead">Join thousands of job seekers and find your perfect opportunity today.</p>
      </div>
      <div class="col-md-3 ml-auto">
        {% if not request.session.email %}
          <a href="{% url 'register' %}" class="btn btn-warning btn-block btn-lg">Sign Up Now</a>
        {% else %}
          <a href="{% url 'my_applications' %}" class="btn btn-warning btn-block btn-lg">My Applications</a>
        {% endif %}
      </div>
    </div>
  </div>
</section>

{% endblock %}
